:root {
  --bg: #f6f7f9; /* neutral background */
  --panel: #ffffff; /* solid panels */
  --panel-solid: #ffffff;
  --text: #111827; /* neutral-900 */
  --text-dim: #6b7280; /* neutral-500 */
  --border: #e5e7eb; /* neutral-200 */
  --primary: #111827; /* use solid neutral for primary */
  --ring: rgba(17, 24, 39, 0.12);
  --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Noto Sans, Ubuntu, Cantarell, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
  /* Fluid type scale */
  --fs-xs: clamp(11px, 0.9vw, 12px);
  --fs-sm: clamp(12px, 1.05vw, 13px);
  --fs-md: clamp(13px, 1.2vw, 15px);
  --fs-lg: clamp(16px, 1.6vw, 18px);
  --fs-xl: clamp(24px, 4vw, 36px);
  /* Elevation */
  --shadow-sm: 0 1px 2px rgba(17, 24, 39, 0.06), 0 1px 1px rgba(17, 24, 39, 0.04);
  --shadow-md: 0 8px 24px rgba(17, 24, 39, 0.08);
  /* Accents */
  --accent-green: #10b981;
  --accent-green-600: #059669;
  --accent-red: #ef4444;
  --accent-red-600: #dc2626;
  --accent-amber: #f59e0b;
  --accent-amber-600: #d97706;
  --accent-blue: #2563eb;
  --accent-blue-600: #1d4ed8;
}

* { box-sizing: border-box; }
html, body {
  margin: 0;
  padding: 0;
  color: var(--text);
  background: var(--bg);
  font-family: var(--sans);
  font-size: var(--fs-md);
  line-height: 1.35;
}

/* When running as an extension popup, constrain size */
html.is-extension, body.is-extension {
  width: 560px;
  height: 640px;
  overflow-y: auto;
  overflow-x: hidden;
}

.app { padding: 12px; max-width: 100%; }

.app-header { display:flex; align-items:center; justify-content:space-between; margin-bottom: 10px; }
.brand { display:flex; align-items:center; gap: 10px; }
.logo { width: 36px; height: 36px; display:grid; place-items:center; border-radius: 8px; background: var(--panel); border: 1px solid var(--border); color: var(--text); box-shadow: var(--shadow-sm); }
.titles h1 { margin: 0; font-size: var(--fs-lg); letter-spacing: .3px; }
.subtitle { margin: 2px 0 0; color: var(--text-dim); font-size: var(--fs-sm); }

/* Tabs */
.tabs-bar { position: sticky; top: 0; z-index: 20; display:flex; justify-content:center; margin: 6px 0 10px; padding-top: 4px; padding-bottom: 6px; background: var(--bg); transition: box-shadow .2s ease; }
.tabs-bar.is-stuck { box-shadow: 0 6px 16px rgba(17,24,39,.06); }
.tabs { display:inline-flex; gap:8px; flex-wrap: wrap; align-items:center; justify-content:center; max-width: 100%; background: var(--panel); border:1px solid var(--border); border-radius: 12px; padding: 6px; box-shadow: var(--shadow-sm); }
.tab { appearance:none; border:1px solid var(--border); background: #f8fafc; color: var(--text-dim); padding:6px 12px; border-radius: 8px; cursor:pointer; font-family: var(--sans); font-size: var(--fs-sm); white-space: nowrap; transition: box-shadow .15s ease, transform .1s ease, background .2s ease; }
.tab.is-active { color: #ffffff; background: var(--primary); border-color: #111827; }
.tab:hover { box-shadow: var(--shadow-sm); transform: translateY(-1px); }
.tab-panel { display:block; }
.tab-panel.is-hidden { display:none; }

.add { margin-bottom: 10px; }
.add-box { display:flex; gap:8px; background: var(--panel); border: 1px solid var(--border); border-radius: 12px; padding: 6px; min-width: 0; align-items:center; box-shadow: var(--shadow-sm); }
.input {
  flex:1; min-width: 0; border: 0; outline: none; background: transparent; color: var(--text);
  padding: 12px 14px; border-radius: 10px; font-size: var(--fs-md);
  min-height: 42px;
}
.input::placeholder { color: var(--text-dim); }

/* Compact overrides for the add task input & button only */
.add .input { min-height: 34px; padding: 8px 10px; font-size: var(--fs-sm); }
.add .btn { flex: 0 0 auto; }
.add .btn.primary { min-height: 34px; padding: 8px 12px; font-size: var(--fs-sm); }

.hint { margin: 6px 2px 0; color: var(--text-dim); font-size: var(--fs-xs); }

.section-header { display:flex; align-items:center; justify-content:space-between; margin: 12px 2px 6px; }
.section-header h2 { font-size: var(--fs-xs); text-transform: uppercase; letter-spacing: .12em; color: #cbd5e1; margin: 0; }
.section-header .right { display:flex; gap:6px; }

.task-list { list-style: none; margin: 0; padding: 0; display:flex; flex-direction:column; gap: 8px; }
.task { display:flex; flex-direction: column; align-items:stretch; gap: 8px; background: var(--panel); border: 1px solid var(--border); border-radius: 12px; padding: 12px; position: relative; transition: transform .15s ease, background .2s ease, border-color .2s ease, box-shadow .2s ease; overflow: hidden; box-shadow: var(--shadow-sm); }
.task:hover { transform: translateY(-1px); border-color: #d1d5db; box-shadow: var(--shadow-md); }

.task .grab { cursor: default; color: #64748b; }

.task .meta { flex:1; min-width: 0; }
.title { margin: 0; font-weight: 700; font-size: var(--fs-md); letter-spacing: .2px; word-break: break-word; }
.title[contenteditable="true"] { outline: none; border-bottom: 1px dashed rgba(255,255,255,.2); }
.subline { color: var(--text-dim); font-size: 12px; margin-top: 2px; display:flex; align-items:center; gap: 8px; justify-content: space-between; }
.badge { display:inline-flex; align-items:center; gap:6px; font: 11px var(--mono); padding: 2px 8px; border-radius: 999px; border: 1px solid var(--border); background: #f3f4f6; }
.badge .dot { width: 6px; height: 6px; border-radius: 999px; background: var(--text-dim); }
.badge.running .dot { background: #4b5563; }
.badge.paused .dot { background: #9ca3af; }
.badge.done  .dot { background: #111827; }

.big-time { font: var(--fs-xl) var(--mono); font-weight: 700; color: var(--text); letter-spacing: 1px; }
.controls { display:flex; align-items:center; gap: 8px; flex-wrap: wrap; }
.btn.icon { width: 40px; height: 40px; padding: 0; display:grid; place-items:center; border-radius: 10px; }
.btn.icon svg { width: 20px; height: 20px; fill: currentColor; }
.sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0, 0, 1px, 1px); white-space: nowrap; border: 0; }
.btn { appearance: none; border: 1px solid var(--border); background: #f3f4f6; color: var(--text); padding: 8px 10px; border-radius: 10px; font-family: var(--sans); font-size: var(--fs-sm); cursor: pointer; transition: transform .08s ease, background .2s ease, border-color .2s ease, color .2s ease, box-shadow .15s ease; }
.btn:hover { border-color: #d1d5db; background: #e5e7eb; box-shadow: var(--shadow-sm); }
.btn:active { transform: translateY(1px); }
.btn.small { padding: 6px 8px; border-radius: 10px; font-size: var(--fs-xs); }
.btn.ghost { background: transparent; }
.btn.primary { background: var(--primary); color: #ffffff; border-color: #111827; box-shadow: var(--shadow-sm); }
.btn.primary:hover { background: #1f2937; box-shadow: var(--shadow-md); }
.btn.play { background: var(--accent-green); border-color: var(--accent-green); color: #ffffff; }
.btn.play:hover { background: var(--accent-green-600); border-color: var(--accent-green-600); }
.btn.pause { background: var(--accent-amber); border-color: var(--accent-amber); color: #ffffff; }
.btn.pause:hover { background: var(--accent-amber-600); border-color: var(--accent-amber-600); }
.btn.stop { background: var(--accent-blue); border-color: var(--accent-blue); color: #ffffff; }
.btn.stop:hover { background: var(--accent-blue-600); border-color: var(--accent-blue-600); }
.btn.reset { background: #eef2f7; border-color: #e5e7eb; color: var(--text); }
.btn.reset:hover { background: #e5e7eb; }
.btn.danger { background: var(--accent-red); border-color: var(--accent-red); color: #ffffff; }
.btn.danger:hover { background: var(--accent-red-600); border-color: var(--accent-red-600); }

/* Focus styles */
.btn:focus-visible, .tab:focus-visible, .input:focus-visible { outline: none; box-shadow: 0 0 0 3px var(--ring); }

.time { font: 12px var(--mono); color: #cbd5e1; }

.app-footer { display:flex; align-items:center; gap: 10px; justify-content:flex-end; margin-top: 12px; padding: 6px 2px 2px; color: var(--text-dim); font-size: 11px; }
.app-footer .link { color: #93c5fd; text-decoration: none; }
.app-footer .link:hover { text-decoration: underline; }

/* Scroll */
::-webkit-scrollbar { width: 10px; }
::-webkit-scrollbar-thumb { background: #e5e7eb; border-radius: 999px; }
::-webkit-scrollbar-thumb:hover { background: #d1d5db; }

/* Expanded task view (no longer used, kept for potential future) */
/* .task.expanded { } */
/* .task .expanded { } */
/* .task .expanded-time { } */

/* Pomodoro */
.pom-config { display:grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 8px; background: var(--panel); border:1px solid var(--border); border-radius: 12px; padding: 10px; }
.pom-config label { display:flex; align-items:center; justify-content:space-between; gap: 8px; font-size: var(--fs-sm); color: var(--text-dim); }
.pom-config input { width: 100px; max-width: 100%; padding: 8px 10px; border:1px solid var(--border); border-radius: 8px; background:#f9fafb; color: var(--text); font-size: var(--fs-sm); min-height: 40px; }
.pom-timer { margin-top: 10px; background: var(--panel); border:1px solid var(--border); border-radius: 12px; padding: 14px; text-align:center; box-shadow: var(--shadow-sm); }
.pom-phase { font-size: 12px; color: var(--text-dim); }
.pom-time { font: clamp(28px, 6vw, 44px) var(--mono); margin: 6px 0 10px; color: var(--text); }
.pom-controls { display:flex; gap: 8px; justify-content:center; }
.pom-meta { margin-top: 6px; color: var(--text-dim); font-size: 12px; }

/* Heatmap */
.heatmap-grid { display:grid; grid-template-columns: repeat(12, minmax(0, 1fr)); gap: 4px; padding: 6px; background: var(--panel); border:1px solid var(--border); border-radius: 12px; width: 100%; box-shadow: var(--shadow-sm); }
.heat-cell { width: 100%; padding-top: 100%; position: relative; border-radius: 3px; background: #eef2f7; border: 1px solid var(--border); }
.heat-cell.level-1 { background: #e5e7eb; }
.heat-cell.level-2 { background: #d1d5db; }
.heat-cell.level-3 { background: #9ca3af; }
.heat-cell.level-4 { background: #6b7280; }
.heat-cell::after { content: attr(data-count); position: absolute; inset: 0; display:none; align-items:center; justify-content:center; font: 10px var(--mono); color: #374151; }
.heat-cell:focus-visible { outline: 2px solid var(--ring); }
